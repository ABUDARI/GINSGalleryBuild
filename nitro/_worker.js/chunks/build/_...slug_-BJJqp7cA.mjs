import{_ as e,u as a,a as t,b as s,c as l,d as n,e as i,o as u,f as o,g as r,h as d,i as p}from"./server.mjs";import{K as v,y as c,e as m,r as g,h,a as f,V as w,G as $}from"../routes/renderer.mjs";import"../_/nitro.mjs";import"node:async_hooks";const y=m({__name:"ImageDetail",__ssrInlineRender:!0,setup(e){g(),g(),g(),g(),g(!1),g(!1);const c=g(100),m=g(0),$=g(0),y=g(0),b=g(100),I=g(0);g(!1),g(1);const x=g(["Contain","Cover","Scale-down","Fill","None"]);g(x.value[0]);const _=g(!1),{images:R,uploadImage:S}=a();t(),s("(max-width: 1024px)");const{currentIndex:j,isFirstImg:k,isLastImg:L}=function(){const e=o(),a=p(),t=g(),s=i(),l=n(),u=e.$file,v=h((()=>u.images.value.findIndex((e=>e.pathname.split(".")[0]===l.params.slug[0])))),c=h((()=>{var e,a;return(null==(a=null==(e=u.images.value)?void 0:e[0])?void 0:a.pathname.split(".")[0])===l.params.slug[0]||!1})),m=h((()=>{var e,a;return(null==(a=null==(e=u.images.value)?void 0:e[u.images.value.length-1])?void 0:a.pathname.split(".")[0])===l.params.slug[0]||!1})),applyFilters=async(e,a,s,l,n,i,u)=>{const o=(void 0).createElement("canvas"),r=o.getContext("2d");o.width=null==e?void 0:e.naturalWidth,o.height=null==e?void 0:e.naturalHeight,r.filter=`contrast(${a}%) blur(${s}px) invert(${l}%)\n      saturate(${n}%) hue-rotate(${i}deg) sepia(${u}%)`,r.drawImage(e,0,0,o.width,o.height);const d=new Image;return d.src=o.toDataURL("image/png"),t.value=d,t};return{downloadImage:async(e,s,l,n,i,u,o,r)=>{await applyFilters(s,l,n,i,u,o,r),t.value&&await d(t.value.src,{baseURL:`${a.public.imageApi}/ipx/_/tmdb/`},"$KqkYjBwe2v").then((a=>{const t=a.data.value,s=URL.createObjectURL(t),l=(void 0).createElement("a");l.setAttribute("href",s),l.setAttribute("download",e),l.click()}))},applyFilters:applyFilters,convertBase64ToFile:async(e,a)=>{var t,s;const l=e.value.currentSrc,n=await fetch(l),i=await n.blob();return new File([i],`${Math.random().toString().split(".")[1]}.${null==(s=null==(t=a.value)?void 0:t.contentType)?void 0:s.split("/").pop()}`,{type:a.value.contentType})},magnifierImage:(e,a,t,s,l=2)=>{s.style.filter!==t.style.filter&&(s.style.filter=t.style.filter);const n=t.getBoundingClientRect(),i=a.getBoundingClientRect(),u=e.pageX-i.left,o=e.pageY-i.top,r=n.width,d=n.height,p=r*(1===l?1.5:l),v=d*(1===l?1.5:l);let c=u/r*100,m=o/d*100;u>.01*r&&(c+=.15*c),o>=.01*d&&(m+=.15*m),s.style.backgroundSize=`${p}px ${v}px`,s.style.backgroundPositionX=c-9+"%",s.style.backgroundPositionY=m-9+"%",s.style.left=u-50+"px",s.style.top=o-50+"px",s.style.zIndex="9999"},initSwipe:e=>{r(e,{passive:!1,onSwipeEnd(e,a){var t,l;"left"===a?m.value?s.push("/"):s.push(`/detail/${null==(t=u.images.value[v.value+1])?void 0:t.pathname.split(".")[0]}`):c.value?s.push("/"):s.push(`/detail/${null==(l=u.images.value[v.value-1])?void 0:l.pathname.split(".")[0]}`)}})},currentIndex:v,isFirstImg:c,isLastImg:m}}();l("$hk2MCeb1yX");const C=n(),F=i();return h((()=>R.value.filter((e=>e.pathname.split(".")[0]===C.params.slug[0]))[0])),u("Escape",(()=>{F.push("/")})),u("ArrowLeft",(()=>{var e;k.value?F.push("/"):F.push(`/detail/${null==(e=R.value[j.value-1])?void 0:e.pathname.split(".")[0]}`)})),u("ArrowRight",(()=>{var e;L.value?F.push("/"):F.push(`/detail/${null==(e=R.value[j.value+1])?void 0:e.pathname.split(".")[0]}`)})),f([c,m,y,b,$,I],(()=>{_.value=!0})),(e,a,t,s)=>{a(`<div${v(s)} data-v-0485107a><div class="absolute inset-0 w-full h-full" data-v-0485107a><img${w("src",`${e.$route.params.slug}`)} class="object-contain w-full h-full blur-[70px] brightness-[.2] will-change-[filter]" alt="" data-v-0485107a></div></div>`)}}}),b=y.setup;y.setup=(e,a)=>{const t=$();return(t.modules||(t.modules=new Set)).add("components/ImageDetail.vue"),b?b(e,a):void 0};const I=Object.assign(e(y,[["__scopeId","data-v-0485107a"]]),{__name:"ImageDetail"}),x={};const _=x.setup;x.setup=(e,a)=>{const t=$();return(t.modules||(t.modules=new Set)).add("pages/detail/[...slug].vue"),_?_(e,a):void 0};const R=e(x,[["ssrRender",function(e,a,t,s){const l=I;a(`<div${v(s)}>`),a(c(l,null,null,t)),a("</div>")}]]);export{R as default};
//# sourceMappingURL=_...slug_-BJJqp7cA.mjs.map
